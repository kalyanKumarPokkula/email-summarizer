(()=>{"use strict";var n={56:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},72:n=>{var e=[];function t(n){for(var t=-1,o=0;o<e.length;o++)if(e[o].identifier===n){t=o;break}return t}function o(n,o){for(var a={},r=[],c=0;c<n.length;c++){var s=n[c],l=o.base?s[0]+o.base:s[0],m=a[l]||0,d="".concat(l," ").concat(m);a[l]=m+1;var p=t(d),u={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var b=i(u,o);o.byIndex=c,e.splice(c,0,{identifier:d,updater:b,references:1})}r.push(d)}return r}function i(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,i){var a=o(n=n||[],i=i||{});return function(n){n=n||[];for(var r=0;r<a.length;r++){var c=t(a[r]);e[c].references--}for(var s=o(n,i),l=0;l<a.length;l++){var m=t(a[l]);0===e[m].references&&(e[m].updater(),e.splice(m,1))}a=s}}},113:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},314:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",o=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),o&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),o&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,o,i,a){"string"==typeof n&&(n=[[null,n,void 0]]);var r={};if(o)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(r[s]=!0)}for(var l=0;l<n.length;l++){var m=[].concat(n[l]);o&&r[m[0]]||(void 0!==a&&(void 0===m[5]||(m[1]="@layer".concat(m[5].length>0?" ".concat(m[5]):""," {").concat(m[1],"}")),m[5]=a),t&&(m[2]?(m[1]="@media ".concat(m[2]," {").concat(m[1],"}"),m[2]=t):m[2]=t),i&&(m[4]?(m[1]="@supports (".concat(m[4],") {").concat(m[1],"}"),m[4]=i):m[4]="".concat(i)),e.push(m))}},e}},365:(n,e,t)=>{t.d(e,{A:()=>c});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([n.id,":root {\n\t--primary-color: #32cd32;\n\t--secondary-color: #90ee90;\n\t--font-color-primary: #070f0a;\n\t--font-color-secondary: #363636;\n\t--background-color: #eeeeee;\n}\n\n.summary-sidebar {\n\twidth: 300px;\n\theight: auto;\n\tbackground-color: var(--background-color);\n\t/* border: 1px solid #e0e0e0; */\n\tborder-radius: 8px;\n\tpadding: 15px;\n\tbox-sizing: border-box;\n\toverflow-y: auto; /* In case summary is long */\n\tmargin-left: 15px; /* Add some left margin to separate from Gmail content */\n\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */\n\tposition: relative; /*  Enable positioning for pseudo-element */\n\tcolor: var(\n\t\t--font-color-secondary\n\t); /* Ensure text is visible on the dark background, adjust if needed */\n}\n\n.summary-sidebar h1 {\n\tcolor: var(--primary-color);\n\tfont-size: 22px;\n}\n\n.summary-sidebar h2 {\n\tcolor: var(--font-color-primary);\n}\n\n.intoCopy ul {\n\tlist-style: none; /* Remove default bullets */\n\tpadding-left: 0; /* Remove default padding */\n}\n\n.intoCopy li::before {\n\tcontent: '➡️ '; /* Add arrow icon before each item */\n\tmargin-right: 5px;\n}\n\n.intoCopy button {\n\tmargin-top: 5%;\n\tbackground-color: var(--primary-color);\n\tcolor: var(--background-color);\n\tfont-size: 16px;\n\twidth: 100%;\n\talign-items: center;\n\tborder: none;\n\tborder-radius: 4px;\n\tpadding: 5% 0 5% 0;\n}\n\n.summary-content {\n\tmargin-top: 10px; /* Adjust margin for better spacing */\n}\n\n.summary-header {\n\tfont-size: 16px;\n\tfont-weight: bold;\n\tmargin-bottom: 10px;\n\tcolor: #1f1f1f; /* Adjust margin for better spacing */\n}\n\n.summary-text {\n\twhite-space: pre-wrap;\n\tline-height: 1.5;\n\tfont-size: 14px;\n\tcolor: #202124;\n}\n\n/* New styles for the email content box */\n.email-content-box {\n\tborder: 1px solid #e0e0e0; /* Light gray border */\n\tborder-radius: 8px; /* Rounded corners */\n\tpadding: 10px; /* Padding inside the box */\n\tbackground-color: #f9f9f9; /* Light background color */\n\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* Subtle shadow */\n\tmargin-top: 20px; /* Space above the content box */\n}\n\n.copy-feedback {\n\tposition: fixed;\n\ttop: 20px;\n\tright: 20px;\n\tbackground-color: #4caf50; /* Green background */\n\tcolor: white;\n\tpadding: 10px;\n\tborder-radius: 5px;\n\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n\tz-index: 1000; /* Ensure it appears above other elements */\n}\n\n.action-items h3 {\n\tcolor: var(--font-color-primary);\n}\n\n.action-items ul {\n\tlist-style: none; /* Remove default bullets */\n\tpadding-left: 0; /* Remove default padding */\n}\n\n.action-items li::before {\n\tcontent: '⚙️ '; /* Add arrow icon before each item */\n\tmargin-right: 5px;\n}\n\n/* Styles for action buttons in the sidebar */\n.actionButtons button {\n\tpadding: 8px 15px;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tborder: none; /* Remove default border */\n\tcolor: white; /* Default text color for primary buttons */\n}\n\n/* Styles for action buttons container to add spacing */\n.actionButtons {\n\tdisplay: flex; /* Use flexbox to easily control spacing */\n\tgap: 10px; /* Add a gap of 10px between the flex items (buttons) */\n\tjustify-content: flex-start; /* Align buttons to the start if container is wider */\n\t/* or justify-content: space-between; if you want buttons to spread out */\n}\n\n/* Styles for action buttons in the sidebar */\n.actionButtons button {\n\tpadding: 8px 15px;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\t/* border: 1px solid var(--primary-color); */\n\tcolor: #ffffff;\n\t/* margin-right: 10px;  No need for margin-right anymore with flex gap */\n}\n\n/* Style for the Copy and Reply buttons (primary color) */\n.actionButtons button:nth-child(1), /* Selects the first button (Copy) */\n  .actionButtons button:nth-child(3)  /* Selects the third button (Reply) */ {\n\tbackground-color: var(--primary-color); /* Gmail-like blue color */\n}\n\n/* Style for the Double Check button (transparent) */\n.actionButtons button:nth-child(2) /* Selects the second button (Double Check) */ {\n\tbackground-color: var(--primary-color);\n\tborder: 1px solid #ccc; /* Light grey border */\n\tcolor: #555; /* Dark grey text */\n\tcolor: inherit;\n\tcolor: black;\n\tcolor: rgba(0, 0, 0, 0.87);\n\tcolor: #202124;\n}\n\n/* Optional: Hover effect */\n.actionButtons button:hover {\n\topacity: 0.9;\n}\n\n/* Optional: Focus effect\n.actionButtons button:focus {\n\toutline: 1px solid #32cd32;\n\toutline-offset: 2px;\n} */\n\n.nav-header {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 10px 5px;\n\t/* border-bottom: 1px solid #e0e0e0; */\n\t/* background-color: #fff; */\n\tposition: sticky;\n\ttop: 0;\n\tz-index: 1;\n}\n\n.back-button {\n\tbackground: none;\n\tborder: none;\n\tfont-size: 24px;\n\tcursor: pointer;\n\tpadding: 5px 10px;\n\tmargin-right: 10px;\n\tcolor: var(--font-color-primary);\n\tborder-radius: 50%;\n\twidth: 36px;\n\theight: 36px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.back-button:hover {\n\ttransform: scale(1.07); /* Enlarge the button slightly */\n\ttransition: transform 0.2s ease; /* Smooth transition effect */\n}\n\n.nav-header h1 {\n\tmargin: 0;\n\tfont-size: 18px;\n\tflex-grow: 1;\n}\n\n.privacy-toggle-container {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 20px;\n\tpadding: 10px;\n\tbackground-color: rgba(50, 205, 50, 0.1);\n\tborder-radius: 8px;\n}\n\n.toggle-label {\n\tcolor: var(--font-color-primary);\n\tfont-size: 16px;\n\tfont-weight: 500;\n}\n\n.switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 50px;\n\theight: 24px;\n}\n\n.switch input {\n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n}\n\n.slider {\n\tposition: absolute;\n\tcursor: pointer;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #ccc;\n\ttransition: 0.4s;\n\tborder-radius: 24px;\n}\n\n.slider:before {\n\tposition: absolute;\n\tcontent: '';\n\theight: 16px;\n\twidth: 16px;\n\tleft: 4px;\n\tbottom: 4px;\n\tbackground-color: white;\n\ttransition: 0.4s;\n\tborder-radius: 50%;\n}\n\ninput:checked + .slider {\n\tbackground-color: var(--primary-color);\n}\n\ninput:checked + .slider:before {\n\ttransform: translateX(26px);\n}\n\n/* Optional hover effect */\n.switch:hover .slider:before {\n\tbox-shadow: 0 0 3px rgba(0, 0, 0, 0.2);\n}\n",""]);const c=r},540:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},601:n=>{n.exports=function(n){return n[1]}},659:n=>{var e={};n.exports=function(n,t){var o=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var i=void 0!==t.layer;i&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,i&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(o,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}}},e={};function t(o){var i=e[o];if(void 0!==i)return i.exports;var a=e[o]={id:o,exports:{}};return n[o](a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0;var o=t(72),i=t.n(o),a=t(825),r=t.n(a),c=t(659),s=t.n(c),l=t(56),m=t.n(l),d=t(540),p=t.n(d),u=t(113),b=t.n(u),y=t(365),h={};h.styleTagTransform=b(),h.setAttributes=m(),h.insert=s().bind(null,"head"),h.domAPI=r(),h.insertStyleElement=p(),i()(y.A,h),y.A&&y.A.locals&&y.A.locals;function g(n){const e=function(n){const e=n.querySelector(".ha h2");if(e)return e.textContent.trim();{console.log('Subject element not found with selector ".ha h2" within email item. Trying a broader search.');const n=document.querySelector(".hP");return n?n.textContent.trim():(console.warn('Subject element not found with selector ".hP" either. Subject might not be accessible or selector is incorrect.'),"Subject not found")}}(n);return`Subject: ${e}\nMail Content:\n${function(){let n="";const e=document.querySelectorAll(".ii.gt");return e&&e.length>0&&e.forEach((e=>{n+=e.textContent+"\n\n"})),n=n.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").replace(/\s*([.,!?;])\s*/g,"$1 "),console.log("getEmailContent() called - Fetched content:",n),n.trim()}()}`}async function f(n){const e=document.querySelector(".mail-summery p"),t=document.querySelector(".action-items ul"),o=document.querySelector(".summary-timer");o&&(o.textContent="(0.0s)"),e.textContent="Loading summary...",t.innerHTML="";const i=document.createElement("li");i.textContent="Fetching action items...",t.appendChild(i);try{const o=performance.now();await new Promise((n=>{const e=setInterval((()=>{document.querySelector(".ii.gt")&&(clearInterval(e),n())}),200);setTimeout((()=>{clearInterval(e),n()}),1e4)}));const i={email:g(n),privacy_mode:C()};if(!i.privacy_mode){const n=k();if(!n){console.error("OpenAI API Key is missing and Privacy Mode is OFF. Summary generation aborted."),e.textContent="Error: OpenAI API Key is missing. Please set it in the sidebar.",t.innerHTML="";const n=document.createElement("li");return n.textContent="API Key required for OpenAI.",void t.appendChild(n)}i.openai_api_key=n}const a=await fetch("http://localhost:8000/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=await a.json(),c=(performance.now()-o)/1e3;console.log(`Summary generated in ${c.toFixed(1)} seconds`),function(n,e){const t=document.querySelector(".mail-summery p"),o=document.querySelector(".action-items ul"),i=document.querySelector(".summary-timer");if(i&&(i.textContent=`(${e.toFixed(1)}s)`),t.textContent=n.summary||"Summary not found.",o.innerHTML="",n.actionItems&&n.actionItems.length>0)n.actionItems.forEach((n=>{const e=document.createElement("li");e.textContent=n,o.appendChild(e)}));else{const n=document.createElement("li");n.textContent="No Action Items",o.appendChild(n)}}(r,c)}catch(n){console.error("Error processing email:",n),e.textContent="Failed to load summary.",t.innerHTML="";const i=document.createElement("li");i.textContent="Failed to fetch action items.",t.appendChild(i),o&&(o.textContent="(error)",o.style.color="red")}}let x=!1,v=localStorage.getItem("openai_api_key");function w(){const n=document.createElement("div");n.className="summary-sidebar summary-sidebar-mailmind";const e=document.createElement("style");e.textContent='\n\t\t.summary-sidebar-mailmind {\n\t\t\tbackground-color: #101728; /* Dark blue-ish background */\n\t\t\tcolor: #FFFFFF;\n\t\t\tpadding: 0; /* Remove padding if nav has its own */\n\t\t\twidth: 360px;\n\t\t\theight: 100vh;\n\t\t\toverflow-y: auto;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n\t\t}\n        .summary-sidebar-mailmind .nav-header-mailmind {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 15px 20px; /* Padding for nav */\n            background-color: #101728; /* Match sidebar, or slightly different if needed */\n            position: sticky;\n            top: 0;\n            z-index: 10;\n        }\n        .summary-sidebar-mailmind .nav-header-mailmind h1 {\n            font-size: 1.4em;\n            font-weight: bold;\n            margin: 0;\n        }\n        .summary-sidebar-mailmind .nav-header-mailmind .back-button-mailmind,\n        .summary-sidebar-mailmind .nav-header-mailmind .close-button-mailmind {\n            color: #FFFFFF;\n            background: transparent;\n            border: none;\n            font-size: 1.5em;\n            cursor: pointer;\n        }\n        .summary-sidebar-mailmind .nav-header-mailmind .close-button-mailmind {\n            font-size: 1.3em;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind {\n            padding: 0 20px 20px 20px; /* Padding for content below nav */\n            text-align: center;\n            flex-grow: 1;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind h2 {\n            font-size: 2em;\n            font-weight: bold;\n            margin-top: 10px;\n            margin-bottom: 10px;\n            line-height: 1.2;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .sub-heading-mailmind {\n            font-size: 0.95em;\n            margin-bottom: 25px;\n            color: #cbd5e0; /* Lighter gray */\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .sub-heading-mailmind .emoji {\n            color: #48bb78; /* Green checkmark */\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .action-buttons-mailmind {\n            display: flex;\n            justify-content: center;\n            gap: 15px;\n            margin-bottom: 25px;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .action-buttons-mailmind button {\n            padding: 12px 20px;\n            border: none;\n            border-radius: 25px;\n            font-size: 1em;\n            font-weight: 600;\n            cursor: pointer;\n            transition: background-color 0.3s ease, transform 0.1s ease;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .action-buttons-mailmind button:active {\n            transform: scale(0.98);\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .get-extension-btn-mailmind {\n            background: linear-gradient(to right, #3b82f6, #2563eb);\n            color: white;\n            min-width: 150px;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .watch-demo-btn-mailmind {\n            background-color: #303958;\n            color: white;\n            min-width: 150px;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .demo-image-placeholder-mailmind {\n            background-color: #1a202c;\n            border-radius: 12px;\n            height: 190px;\n            margin-bottom: 30px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            background-image: url(\'https://raw.githubusercontent.com/kalyanKumarPokkula/email-summarizer/main/client/public/logo.png\');\n            background-size: contain;\n            background-repeat: no-repeat;\n            background-position: center;\n            border: 1px solid #2d3748;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .section-title-mailmind {\n            font-size: 1.25em;\n            font-weight: bold;\n            margin-top: 30px;\n            margin-bottom: 20px;\n            text-align: left;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .section-title-mailmind .emoji {\n            margin-right: 8px;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .how-it-works-steps-mailmind {\n            display: flex;\n            justify-content: space-between; /* Changed to space-between */\n            margin-bottom: 30px;\n            text-align: center;\n            gap: 10px; /* Added gap */\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .how-it-works-step-mailmind {\n            flex: 1;\n            padding: 10px 5px; /* Added some padding */\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .step-number-mailmind {\n            background-color: #2563eb;\n            color: white;\n            border-radius: 50%;\n            width: 30px;\n            height: 30px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .step-text-mailmind {\n            font-size: 0.9em;\n            color: #e2e8f0;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .features-list-mailmind button {\n            display: flex;\n            align-items: center;\n            background-color: #1a2233;\n            color: white;\n            padding: 15px;\n            border-radius: 8px;\n            border: 1px solid #2d3748;\n            width: 100%;\n            text-align: left;\n            margin-bottom: 10px;\n            font-size: 0.95em;\n            cursor: pointer;\n        }\n        .summary-sidebar-mailmind .welcome-screen-mailmind .features-list-mailmind .feature-icon-mailmind {\n            font-size: 1.4em;\n            margin-right: 15px;\n            width: 28px; /* For alignment */\n            text-align: center;\n            color: #60a5fa; /* Icon color */\n        }\n         .summary-sidebar-mailmind .welcome-screen-mailmind .features-list-mailmind .feature-icon-mailmind.chat-icon { color: #facc15; } /* Yellow for chat */\n         .summary-sidebar-mailmind .welcome-screen-mailmind .features-list-mailmind .feature-icon-mailmind.copy-icon { color: #a78bfa; } /* Purple for copy */\n         .summary-sidebar-mailmind .welcome-screen-mailmind .features-list-mailmind .feature-icon-mailmind.check-icon { color: #fb7185; } /* Pink for double check */\n\n        .summary-sidebar-mailmind .welcome-screen-mailmind .feature-text-mailmind .coming-soon-mailmind {\n            font-size: 0.8em;\n            color: #94a3b8;\n            margin-left: 5px;\n        }\n        .summary-sidebar-mailmind .settings-section-mailmind {\n            margin-top: 20px;\n            padding-top: 20px;\n            border-top: 1px solid #2d3748;\n            text-align: left;\n        }\n        .summary-sidebar-mailmind .api-key-container-mailmind {\n            background-color: #1a2233;\n            padding: 15px;\n            border-radius: 8px;\n            margin-top: 10px;\n            border: 1px solid #2d3748;\n        }\n        .summary-sidebar-mailmind .api-key-container-mailmind label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: 500;\n            font-size: 0.9em;\n        }\n        .summary-sidebar-mailmind .api-key-container-mailmind input[type="password"] {\n            width: calc(100% - 22px);\n            padding: 10px;\n            margin-bottom: 10px;\n            border: 1px solid #3e4c62;\n            border-radius: 4px;\n            background-color: #101728;\n            color: white;\n            font-size: 0.9em;\n        }\n        .summary-sidebar-mailmind .api-key-container-mailmind button {\n            padding: 8px 15px;\n            border: none;\n            border-radius: 4px;\n            background-color: #38a169;\n            color: white;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.9em;\n        }\n        .summary-sidebar-mailmind .privacy-toggle-container-mailmind {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: 12px 15px;\n            background-color: #1a2233;\n            border-radius: 8px;\n            margin-bottom: 10px;\n            border: 1px solid #2d3748;\n        }\n        .summary-sidebar-mailmind .toggle-label-mailmind {\n            font-size: 0.95em;\n            margin-right: 10px;\n            font-weight: 500;\n        }\n        .summary-sidebar-mailmind .switch-mailmind {\n            position: relative;\n            display: inline-block;\n            width: 44px;\n            height: 24px;\n        }\n        .summary-sidebar-mailmind .switch-mailmind input { display: none; }\n        .summary-sidebar-mailmind .slider-mailmind {\n            position: absolute;\n            cursor: pointer;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: #3e4c62;\n            transition: .4s;\n            border-radius: 24px;\n        }\n        .summary-sidebar-mailmind .slider-mailmind:before {\n            position: absolute;\n            content: "";\n            height: 18px;\n            width: 18px;\n            left: 3px;\n            bottom: 3px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n        }\n        .summary-sidebar-mailmind input:checked + .slider-mailmind {\n            background-color: #38a169;\n        }\n        .summary-sidebar-mailmind input:checked + .slider-mailmind:before {\n            transform: translateX(20px);\n        }\n        /* Summary Box styles from original code - ensure they don\'t conflict or adapt them */\n        .summary-sidebar-mailmind .summery-box { /* Renamed to avoid conflicts with potential global styles */\n            padding: 15px; /* Add padding to summary box content */\n            background-color: #101728; /* Ensure it matches */\n            flex-grow: 1; /* Allow it to take space */\n        }\n        .summary-sidebar-mailmind .mail-summery h3, .summary-sidebar-mailmind .action-items h3 {\n             margin-top: 0;\n             margin-bottom: 10px;\n             font-size: 1.1em;\n        }\n        .summary-sidebar-mailmind .mail-summery p, .summary-sidebar-mailmind .action-items ul {\n            font-size: 0.9em;\n            color: #cbd5e0;\n            line-height: 1.6;\n        }\n        .summary-sidebar-mailmind .action-items ul { list-style-type: disc; padding-left: 20px; }\n        .summary-sidebar-mailmind .actionButtons button {\n            background-color: #2563eb;\n            color: white;\n            border: none;\n            padding: 8px 12px;\n            margin-right: 10px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 0.9em;\n        }\n        .summary-sidebar-mailmind .actionButtons button:hover { background-color: #1d4ed8; }\n        .summary-sidebar-mailmind .summary-header-container {\n             display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;\n        }\n        .summary-sidebar-mailmind .summary-timer { font-size: 0.8em; color: #a0aec0; }\n\n\t',document.head.appendChild(e);const t=document.createElement("nav");t.className="nav-header-mailmind";const o=document.createElement("button");o.className="back-button-mailmind",o.innerHTML="⬅️",o.style.display="none";const i=document.createElement("h1");i.innerHTML="MailMind AI ✨";const a=document.createElement("button");a.className="close-button-mailmind",a.innerHTML="✖",a.title="Close sidebar";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.appendChild(o),r.appendChild(i),t.appendChild(r),t.appendChild(a),n.appendChild(t);const c=document.createElement("div");c.className="welcome-screen-mailmind";const s=document.createElement("h2");s.innerHTML="Supercharge your inbox <br>with AI-powered summaries ❤️",c.appendChild(s);const l=document.createElement("p");l.className="sub-heading-mailmind",l.innerHTML='<span class="emoji">✅</span> Summarize emails. <span class="emoji">✅</span> Extract action items. <span class="emoji">✅</span> Reply smart.',c.appendChild(l);const m=document.createElement("div");m.className="action-buttons-mailmind";const d=document.createElement("button");d.className="get-extension-btn-mailmind",d.innerHTML="⬇️ Get the Extension";const p=document.createElement("button");p.className="watch-demo-btn-mailmind",p.innerHTML="▶️ Watch Demo",m.appendChild(d),m.appendChild(p),c.appendChild(m);const u=document.createElement("div");u.className="demo-image-placeholder-mailmind",c.appendChild(u);const b=document.createElement("h3");b.className="section-title-mailmind",b.innerHTML='<span class="emoji">✨</span> How It Works',c.appendChild(b);const y=document.createElement("div");y.className="how-it-works-steps-mailmind",[{number:"1",text:"Open your email"},{number:"2",text:"Let MailMind summarize"},{number:"3",text:"Copy or reply instantly"}].forEach((n=>{const e=document.createElement("div");e.className="how-it-works-step-mailmind";const t=document.createElement("div");t.className="step-number-mailmind",t.textContent=n.number;const o=document.createElement("p");o.className="step-text-mailmind",o.textContent=n.text,e.appendChild(t),e.appendChild(o),y.appendChild(e)})),c.appendChild(y);const h=document.createElement("h3");h.className="section-title-mailmind",h.innerHTML='<span class="emoji">⚙️</span> Features That Make You Productive',c.appendChild(h);const w=document.createElement("div");w.className="features-list-mailmind",[{icon:"🪄",text:"AI-Powered Summaries"},{icon:"📋",text:"Actionable Task Extraction"},{icon:"💬",text:"Smart Replies",comingSoon:!0,iconClass:"chat-icon"},{icon:"🔗",text:"Copy & Share in One Click",iconClass:"copy-icon"},{icon:"❔",text:"Double-check summaries",iconClass:"check-icon"}].forEach((n=>{w.appendChild(function(n,e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";const i=document.createElement("button"),a=document.createElement("span");a.className="feature-icon-mailmind "+o,a.textContent=n;const r=document.createElement("span");if(r.className="feature-text-mailmind",r.textContent=e,t){const n=document.createElement("span");n.className="coming-soon-mailmind",n.textContent="(coming soon)",r.appendChild(n)}return i.appendChild(a),i.appendChild(r),i}(n.icon,n.text,n.comingSoon,n.iconClass))})),c.appendChild(w);const E=document.createElement("div");E.className="settings-section-mailmind",c.appendChild(E);const S=document.createElement("div");S.className="privacy-toggle-container-mailmind";const A=document.createElement("label");A.className="toggle-label-mailmind",A.textContent="Privacy Mode (Use Local LLM)";const N=document.createElement("label");N.className="switch-mailmind";const I=document.createElement("input");I.type="checkbox";const L=document.createElement("span");L.className="slider-mailmind",N.appendChild(I),N.appendChild(L),S.appendChild(A),S.appendChild(N),E.appendChild(S);const T=document.createElement("div");T.className="api-key-container-mailmind",T.style.display="none";const M=document.createElement("label");M.textContent="OpenAI API Key:";const z=document.createElement("input");z.type="password",z.placeholder="Enter your OpenAI API Key";const P=document.createElement("button");function j(){v=localStorage.getItem("openai_api_key"),T.style.display=x||v?"none":"block"}P.textContent="Save API Key",T.appendChild(M),T.appendChild(z),T.appendChild(P),E.appendChild(T),j(),P.addEventListener("click",(()=>{const n=z.value.trim();n?(localStorage.setItem("openai_api_key",n),v=n,z.value="",j()):alert("Please enter a valid API Key.")})),I.addEventListener("change",(()=>{x=I.checked,console.log("Privacy Mode:",x?"ON (Local LLM)":"OFF (OpenAI)"),j()})),n.appendChild(c);const F=document.createElement("div");F.className="summery-box",F.style.display="none";const O=document.createElement("div");O.className="mail-summery";const H=document.createElement("div");H.className="summary-header-container";const q=document.createElement("h3");q.textContent="Summary:";const R=document.createElement("span");R.className="summary-timer",R.textContent="(0.0s)",H.appendChild(q),H.appendChild(R),O.appendChild(H);const _=document.createElement("p");O.appendChild(_);const B=document.createElement("div");B.className="action-items";const D=document.createElement("h3");D.textContent="Action Items:";const K=document.createElement("ul");B.appendChild(D),B.appendChild(K);const U=document.createElement("div");U.className="actionButtons";const $=document.createElement("button");$.textContent="Copy";const G=document.createElement("button");G.textContent="Reply";const Y=document.createElement("button");return Y.textContent="Double Check",U.appendChild($),U.appendChild(Y),U.appendChild(G),F.appendChild(O),F.appendChild(B),F.appendChild(U),n.appendChild(F),a.addEventListener("click",(()=>{n.style.display="none"})),o.addEventListener("click",(()=>{F.style.display="none",o.style.display="none",c.style.display="block",j()})),document.addEventListener("click",(e=>{e.target.closest(".zA")&&"none"!==n.style.display&&(c.style.display="none",F.style.display="block",o.style.display="block")})),$.addEventListener("click",(()=>{(async n=>{try{await navigator.clipboard.writeText(n),(n=>{const e=document.createElement("div");e.textContent=n,e.className="copy-feedback",document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e)}),2e3)})("Summary copied to clipboard!")}catch(n){console.error("Failed to copy:",n)}})(_.textContent)})),Y.addEventListener("click",(n=>{console.log("Double check clicked"),async function(){const n=document.querySelector(".zA.yO");n?await f(n):(console.error("No email selected for double check"),document.querySelector(".mail-summery p").textContent="Please select an email first.")}()})),G.addEventListener("click",(async()=>{console.log("Reply clicked"),await async function(){try{console.log("Starting reply process...");const e=document.querySelector(".zA.yO");if(!e)throw new Error("No email selected");console.log("Email item found");const t=g(e);console.log("Email content:",t);const o=document.querySelector('[aria-label="Reply"]');if(!o)throw new Error("Reply button not found");{o.click(),await(n=".Am.Al.editable",new Promise((e=>{if(document.querySelector(n))return e();const t=new MutationObserver((()=>{document.querySelector(n)&&(t.disconnect(),e())}));t.observe(document.body,{childList:!0,subtree:!0}),setTimeout((()=>{t.disconnect(),e()}),5e3)})));const e=document.querySelector(".Am.Al.editable");if(e){e.innerHTML="Generating reply...<br><br>";const n={email_content:t,privacy_mode:C()};if(!n.privacy_mode){const t=k();if(!t)return console.error("OpenAI API Key is missing and Privacy Mode is OFF. Reply generation aborted."),void(e.innerHTML="Error: OpenAI API Key is missing. Please set it in the sidebar.<br><br>");n.openai_api_key=t}console.log("Sending request to server...");const o=await fetch("http://localhost:8000/reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);try{const n=await o.json();console.log("Parsed response data:",n);let t="string"==typeof n?n:n.reply;if(!t)throw new Error("No reply text found in response");t=t.replace(/\[Sender's Name\]/g,"").replace(/\[Your Full Name\]/g,"").replace(/\[Your Contact Information\]/g,"").replace(/\n/g,"<br>").replace(/<br><br><br>/g,"<br><br>"),e.innerHTML=t}catch(n){console.error("Error parsing JSON:",n);const t=await o.text();e.innerHTML=t.replace(/\[Sender's Name\]/g,"").replace(/\[Your Full Name\]/g,"").replace(/\[Your Contact Information\]/g,"").replace(/\n/g,"<br>").replace(/<br><br><br>/g,"<br><br>")}const i=window.getSelection(),a=document.createRange();a.selectNodeContents(e),a.collapse(!1),i.removeAllRanges(),i.addRange(a)}}}catch(n){console.error("Error handling reply:",n),alert("Failed to generate reply. Please try again.")}var n}()})),n}function C(){return x}function k(){return localStorage.getItem("openai_api_key")}window.addEventListener("load",(function(){const n=w(),e=document.querySelector(".aUx");e?e.insertBefore(n,e.firstChild):console.error("Target container (.aUx) not found."),async function(){document.addEventListener("click",(async n=>{const e=n.target.closest(".zA");if(e){const n=document.querySelector(".summery-box");document.querySelector(".intoCopy").style.display="none",n.style.display="block",await f(e)}}))}()}))})();