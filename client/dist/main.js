(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var a={},c=[],i=0;i<e.length;i++){var s=e[i],l=o.base?s[0]+o.base:s[0],d=a[l]||0,p="".concat(l," ").concat(d);a[l]=d+1;var u=n(p),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var y=r(m,o);o.byIndex=i,t.splice(i,0,{identifier:p,updater:y,references:1})}c.push(p)}return c}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var c=0;c<a.length;c++){var i=n(a[c]);t[i].references--}for(var s=o(e,r),l=0;l<a.length;l++){var d=n(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=s}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var c={};if(o)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(c[s]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&c[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},365:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(601),r=n.n(o),a=n(314),c=n.n(a)()(r());c.push([e.id,":root {\n\t--primary-color: #32cd32;\n\t--secondary-color: #90ee90;\n\t--font-color-primary: #070f0a;\n\t--font-color-secondary: #363636;\n\t--background-color: #eeeeee;\n}\n\n.summary-sidebar {\n\twidth: 300px;\n\theight: auto;\n\tbackground-color: var(--background-color);\n\t/* border: 1px solid #e0e0e0; */\n\tborder-radius: 8px;\n\tpadding: 15px;\n\tbox-sizing: border-box;\n\toverflow-y: auto; /* In case summary is long */\n\tmargin-left: 15px; /* Add some left margin to separate from Gmail content */\n\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */\n\tposition: relative; /*  Enable positioning for pseudo-element */\n\tcolor: var(\n\t\t--font-color-secondary\n\t); /* Ensure text is visible on the dark background, adjust if needed */\n}\n\n.summary-sidebar h1 {\n\tcolor: var(--primary-color);\n\tfont-size: 22px;\n}\n\n.summary-sidebar h2 {\n\tcolor: var(--font-color-primary);\n}\n\n.intoCopy ul {\n\tlist-style: none; /* Remove default bullets */\n\tpadding-left: 0; /* Remove default padding */\n}\n\n.intoCopy li::before {\n\tcontent: '➡️ '; /* Add arrow icon before each item */\n\tmargin-right: 5px;\n}\n\n.intoCopy button {\n\tmargin-top: 5%;\n\tbackground-color: var(--primary-color);\n\tcolor: var(--background-color);\n\tfont-size: 16px;\n\twidth: 100%;\n\talign-items: center;\n\tborder: none;\n\tborder-radius: 4px;\n\tpadding: 5% 0 5% 0;\n}\n\n.summary-content {\n\tmargin-top: 10px; /* Adjust margin for better spacing */\n}\n\n.summary-header {\n\tfont-size: 16px;\n\tfont-weight: bold;\n\tmargin-bottom: 10px;\n\tcolor: #1f1f1f; /* Adjust margin for better spacing */\n}\n\n.summary-text {\n\twhite-space: pre-wrap;\n\tline-height: 1.5;\n\tfont-size: 14px;\n\tcolor: #202124;\n}\n\n/* New styles for the email content box */\n.email-content-box {\n\tborder: 1px solid #e0e0e0; /* Light gray border */\n\tborder-radius: 8px; /* Rounded corners */\n\tpadding: 10px; /* Padding inside the box */\n\tbackground-color: #f9f9f9; /* Light background color */\n\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* Subtle shadow */\n\tmargin-top: 20px; /* Space above the content box */\n}\n\n.copy-feedback {\n\tposition: fixed;\n\ttop: 20px;\n\tright: 20px;\n\tbackground-color: #4caf50; /* Green background */\n\tcolor: white;\n\tpadding: 10px;\n\tborder-radius: 5px;\n\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n\tz-index: 1000; /* Ensure it appears above other elements */\n}\n\n.action-items h3 {\n\tcolor: var(--font-color-primary);\n}\n\n.action-items ul {\n\tlist-style: none; /* Remove default bullets */\n\tpadding-left: 0; /* Remove default padding */\n}\n\n.action-items li::before {\n\tcontent: '⚙️ '; /* Add arrow icon before each item */\n\tmargin-right: 5px;\n}\n\n/* Styles for action buttons in the sidebar */\n.actionButtons button {\n\tpadding: 8px 15px;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tborder: none; /* Remove default border */\n\tcolor: white; /* Default text color for primary buttons */\n}\n\n/* Styles for action buttons container to add spacing */\n.actionButtons {\n\tdisplay: flex; /* Use flexbox to easily control spacing */\n\tgap: 10px; /* Add a gap of 10px between the flex items (buttons) */\n\tjustify-content: flex-start; /* Align buttons to the start if container is wider */\n\t/* or justify-content: space-between; if you want buttons to spread out */\n}\n\n/* Styles for action buttons in the sidebar */\n.actionButtons button {\n\tpadding: 8px 15px;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\t/* border: 1px solid var(--primary-color); */\n\tcolor: #ffffff;\n\t/* margin-right: 10px;  No need for margin-right anymore with flex gap */\n}\n\n/* Style for the Copy and Reply buttons (primary color) */\n.actionButtons button:nth-child(1), /* Selects the first button (Copy) */\n  .actionButtons button:nth-child(3)  /* Selects the third button (Reply) */ {\n\tbackground-color: var(--primary-color); /* Gmail-like blue color */\n}\n\n/* Style for the Double Check button (transparent) */\n.actionButtons button:nth-child(2) /* Selects the second button (Double Check) */ {\n\tbackground-color: var(--primary-color);\n\tborder: 1px solid #ccc; /* Light grey border */\n\tcolor: #555; /* Dark grey text */\n\tcolor: inherit;\n\tcolor: black;\n\tcolor: rgba(0, 0, 0, 0.87);\n\tcolor: #202124;\n}\n\n/* Optional: Hover effect */\n.actionButtons button:hover {\n\topacity: 0.9;\n}\n\n/* Optional: Focus effect\n.actionButtons button:focus {\n\toutline: 1px solid #32cd32;\n\toutline-offset: 2px;\n} */\n\n.nav-header {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 10px 5px;\n\t/* border-bottom: 1px solid #e0e0e0; */\n\t/* background-color: #fff; */\n\tposition: sticky;\n\ttop: 0;\n\tz-index: 1;\n}\n\n.back-button {\n\tbackground: none;\n\tborder: none;\n\tfont-size: 24px;\n\tcursor: pointer;\n\tpadding: 5px 10px;\n\tmargin-right: 10px;\n\tcolor: var(--font-color-primary);\n\tborder-radius: 50%;\n\twidth: 36px;\n\theight: 36px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.back-button:hover {\n\ttransform: scale(1.07); /* Enlarge the button slightly */\n\ttransition: transform 0.2s ease; /* Smooth transition effect */\n}\n\n.nav-header h1 {\n\tmargin: 0;\n\tfont-size: 18px;\n\tflex-grow: 1;\n}\n\n.privacy-toggle-container {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 20px;\n\tpadding: 10px;\n\tbackground-color: rgba(50, 205, 50, 0.1);\n\tborder-radius: 8px;\n}\n\n.toggle-label {\n\tcolor: var(--font-color-primary);\n\tfont-size: 16px;\n\tfont-weight: 500;\n}\n\n.switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 50px;\n\theight: 24px;\n}\n\n.switch input {\n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n}\n\n.slider {\n\tposition: absolute;\n\tcursor: pointer;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #ccc;\n\ttransition: 0.4s;\n\tborder-radius: 24px;\n}\n\n.slider:before {\n\tposition: absolute;\n\tcontent: '';\n\theight: 16px;\n\twidth: 16px;\n\tleft: 4px;\n\tbottom: 4px;\n\tbackground-color: white;\n\ttransition: 0.4s;\n\tborder-radius: 50%;\n}\n\ninput:checked + .slider {\n\tbackground-color: var(--primary-color);\n}\n\ninput:checked + .slider:before {\n\ttransform: translateX(26px);\n}\n\n/* Optional hover effect */\n.switch:hover .slider:before {\n\tbox-shadow: 0 0 3px rgba(0, 0, 0, 0.2);\n}\n",""]);const i=c},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,exports:{}};return e[o](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var o=n(72),r=n.n(o),a=n(825),c=n.n(a),i=n(659),s=n.n(i),l=n(56),d=n.n(l),p=n(540),u=n.n(p),m=n(113),y=n.n(m),f=n(365),h={};h.styleTagTransform=y(),h.setAttributes=d(),h.insert=s().bind(null,"head"),h.domAPI=c(),h.insertStyleElement=u(),r()(f.A,h),f.A&&f.A.locals&&f.A.locals;function b(e){const t=function(e){const t=e.querySelector(".ha h2");if(t)return t.textContent.trim();{console.log('Subject element not found with selector ".ha h2" within email item. Trying a broader search.');const e=document.querySelector(".hP");return e?e.textContent.trim():(console.warn('Subject element not found with selector ".hP" either. Subject might not be accessible or selector is incorrect.'),"Subject not found")}}(e);return`Subject: ${t}\nMail Content:\n${function(){let e="";const t=document.querySelectorAll(".ii.gt");return t&&t.length>0&&t.forEach((t=>{e+=t.textContent+"\n\n"})),e=e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").replace(/\s*([.,!?;])\s*/g,"$1 "),console.log("getEmailContent() called - Fetched content:",e),e.trim()}()}`}async function g(e){const t=document.querySelector(".mail-summery p"),n=document.querySelector(".action-items ul"),o=document.querySelector(".summary-timer");o&&(o.textContent="(0.0s)"),t.textContent="Loading summary...",n.innerHTML="";const r=document.createElement("li");r.textContent="Fetching action items...",n.appendChild(r);try{const t=performance.now();await new Promise((e=>{const t=setInterval((()=>{document.querySelector(".ii.gt")&&(clearInterval(t),e())}),200);setTimeout((()=>{clearInterval(t),e()}),1e4)}));const n=b(e),o=await fetch("http://localhost:8000/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,privacy_mode:C()})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=await o.json(),a=(performance.now()-t)/1e3;console.log(`Summary generated in ${a.toFixed(1)} seconds`),function(e,t){const n=document.querySelector(".mail-summery p"),o=document.querySelector(".action-items ul"),r=document.querySelector(".summary-timer");if(r&&(r.textContent=`(${t.toFixed(1)}s)`),n.textContent=e.summary||"Summary not found.",o.innerHTML="",e.actionItems&&e.actionItems.length>0)e.actionItems.forEach((e=>{const t=document.createElement("li");t.textContent=e,o.appendChild(t)}));else{const e=document.createElement("li");e.textContent="No Action Items",o.appendChild(e)}}(r,a)}catch(e){console.error("Error processing email:",e),t.textContent="Failed to load summary.",n.innerHTML="";const r=document.createElement("li");r.textContent="Failed to fetch action items.",n.appendChild(r),o&&(o.textContent="(error)",o.style.color="red")}}let x=!1;function v(){const e=document.createElement("div");e.className="summary-sidebar";const t=document.createElement("div");t.className="container";const n=document.createElement("nav");n.className="nav-header";const o=document.createElement("button");o.className="back-button",o.innerHTML="⬅️",o.style.display="none";const r=document.createElement("h1");r.innerHTML="MailMind AI ✨",n.appendChild(o),n.appendChild(r);const a=document.createElement("div");a.className="summery-box",a.style.display="none";const c=document.createElement("div");c.className="mail-summery";const i=document.createElement("div");i.className="summary-header-container",i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center";const s=document.createElement("h3");s.textContent="Summary:";const l=document.createElement("span");l.className="summary-timer",l.textContent="(0.0s)",l.style.fontSize="0.8em",l.style.color="#666",i.appendChild(s),i.appendChild(l),c.appendChild(i);const d=document.createElement("p");c.appendChild(d);const p=document.createElement("div");p.className="action-items";const u=document.createElement("h3");u.textContent="Action Items:";const m=document.createElement("ul");p.appendChild(u),p.appendChild(m);const y=document.createElement("div");y.className="actionButtons";const f=document.createElement("button");f.textContent="Copy";const h=document.createElement("button");h.textContent="Reply";const v=document.createElement("button");v.textContent="Double Check",y.appendChild(f),y.appendChild(v),y.appendChild(h),a.appendChild(c),a.appendChild(p),a.appendChild(y);const w=document.createElement("div");w.className="intoCopy";const E=document.createElement("h2");E.innerHTML='🚀 <span style="color: #32cd32;">Supercharge</span> your gmail with <span style="color: #32cd32;">MailMind AI</span>';const S=document.createElement("p");S.textContent="Tired of reading long emails? MailMind AI brings AI-powered summaries right into your Gmail sidebar. Instantly get the key points, copy, double-check, or reply in seconds—saving you time and effort. Stay focused, work smarter, and never miss important details again!";const k=document.createElement("div"),A=document.createElement("h3");A.textContent="What can we do with MailMind AI?",k.appendChild(A);const N=document.createElement("ul");["Get Summary","Get Action Item (if any)","Double Check"].forEach((e=>{const t=document.createElement("li");t.textContent=e,N.appendChild(t)})),k.appendChild(N);const T=document.createElement("button");T.textContent="Try Now ✨ (by selecting mail)";const M=document.createElement("div");M.className="privacy-toggle-container";const I=document.createElement("label");I.className="toggle-label",I.textContent="Privacy Mode";const L=document.createElement("label");L.className="switch";const q=document.createElement("input");q.type="checkbox";const j=document.createElement("span");return j.className="slider",L.appendChild(q),L.appendChild(j),M.appendChild(I),M.appendChild(L),w.appendChild(E),w.appendChild(S),w.appendChild(k),w.appendChild(T),w.appendChild(M),t.appendChild(n),t.appendChild(a),t.appendChild(w),e.appendChild(t),o.addEventListener("click",(()=>{a.style.display="none",o.style.display="none",w.style.display="block"})),w.style.display,document.addEventListener("click",(async e=>{e.target.closest(".zA")&&(w.style.display="none",a.style.display="block",o.style.display="block")})),f.addEventListener("click",(()=>{(async e=>{try{await navigator.clipboard.writeText(e),(e=>{const t=document.createElement("div");t.textContent=e,t.className="copy-feedback",document.body.appendChild(t),setTimeout((()=>{document.body.removeChild(t)}),2e3)})("Summary copied to clipboard!")}catch(e){console.error("Failed to copy:",e)}})(document.querySelector(".mail-summery p").textContent)})),v.addEventListener("click",(e=>{console.log("Double check clicked"),async function(){const e=document.querySelector(".zA.yO");e?await g(e):(console.error("No email selected for double check"),document.querySelector(".mail-summery p").textContent="Please select an email first.")}()})),h.addEventListener("click",(async()=>{console.log("Reply clicked"),async function(){try{console.log("Starting reply process...");const t=document.querySelector(".zA.yO");if(!t)throw new Error("No email selected");console.log("Email item found");const n=b(t);console.log("Email content:",n);const o=document.querySelector('[aria-label="Reply"]');if(!o)throw new Error("Reply button not found");{o.click(),await(e=".Am.Al.editable",new Promise((t=>{if(document.querySelector(e))return t();const n=new MutationObserver((()=>{document.querySelector(e)&&(n.disconnect(),t())}));n.observe(document.body,{childList:!0,subtree:!0}),setTimeout((()=>{n.disconnect(),t()}),5e3)})));const t=document.querySelector(".Am.Al.editable");if(t){t.innerHTML="Generating reply...<br><br>",console.log("Sending request to server...");const e=await fetch("http://localhost:8000/reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,privacy_mode:C()})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);try{const n=await e.json();console.log("Parsed response data:",n);let o="string"==typeof n?n:n.reply;if(!o)throw new Error("No reply text found in response");o=o.replace(/\[Sender's Name\]/g,"").replace(/\[Your Full Name\]/g,"").replace(/\[Your Contact Information\]/g,"").replace(/\n/g,"<br>").replace(/<br><br><br>/g,"<br><br>"),t.innerHTML=o}catch(n){console.error("Error parsing JSON:",n);const o=await e.text();t.innerHTML=o.replace(/\[Sender's Name\]/g,"").replace(/\[Your Full Name\]/g,"").replace(/\[Your Contact Information\]/g,"").replace(/\n/g,"<br>").replace(/<br><br><br>/g,"<br><br>")}const o=window.getSelection(),r=document.createRange();r.selectNodeContents(t),r.collapse(!1),o.removeAllRanges(),o.addRange(r)}}}catch(e){console.error("Error handling reply:",e),alert("Failed to generate reply. Please try again.")}var e}()})),q.addEventListener("change",(e=>{x=e.target.checked,console.log("Privacy Mode:",x)})),e}function C(){return x}window.addEventListener("load",(function(){const e=v(),t=document.querySelector(".aUx");t?t.insertBefore(e,t.firstChild):console.error("Target container (.aUx) not found."),async function(){document.addEventListener("click",(async e=>{const t=e.target.closest(".zA");if(t){const e=document.querySelector(".summery-box");document.querySelector(".intoCopy").style.display="none",e.style.display="block",await g(t)}}))}()}))})();